(this["webpackJsonpgun-ui"]=this["webpackJsonpgun-ui"]||[]).push([[0],{161:function(e,n){function t(e){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}t.keys=function(){return[]},t.resolve=t,e.exports=t,t.id=161},213:function(e,n,t){},215:function(e,n,t){},353:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),c=t(92),o=t.n(c),u=(t(213),t(25)),i=t(128),s=t(7),l=t.n(s),d=t(19),f=t(12),p=(t(215),t(118)),b=t.n(p),h=(t(218),t(192)),g=t(13);function v(){var e;window.log&&(e=console).log.apply(e,arguments)}var j=a.a.memo((function(e){var n=e.graph,t=e.valuesEnabled,a=e.search,c=Object(r.useState)({}),o=Object(f.a)(c,2),u=o[0],i=o[1];return Object(r.useEffect)((function(){Object(d.a)(l.a.mark((function e(){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(n,t,a);case 2:r=e.sent,i(r);case 4:case"end":return e.stop()}}),e)})))()}),[n,t,a]),Object(g.jsx)(h.a,{root:u,margin:{top:20,right:20,bottom:20,left:20},identity:"name",colorBy:"depth",label:function(e){return e.data.label},enableLabels:!0,value:"loc",colors:{scheme:"spectral"},padding:0,labelSkipRadius:0,labelTextColor:"black",borderWidth:2,borderColor:{from:"color"},defs:[{id:"lines",type:"patternLines",background:"none",color:"inherit",rotation:-75,lineWidth:5,spacing:8}],fill:[{match:{depth:1},id:"lines"}],animate:!0,motionStiffness:90,motionDamping:12})}));t(352);var x=new Set,O=[{id:"gun",props:{root:""}}],k=[],w=function(e,n,t){return new Promise((function(r,a){try{e.auth(n,t,r)}catch(c){a(c)}}))};var m=new Map,y=function(e){return JSON.stringify(e,null,4).replace(/\\/g,"").replace(/,/g,",\r\n").replace("\r\n\r\n","\r\n")},C=function(){var e=Object(d.a)(l.a.mark((function e(n){var t,r,a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=y(n.props),!m.has(t)){e.next=5;break}r=m.get(t),e.next=24;break;case 5:if(!(a=n.props&&window.gun?window.gun.user()._.sea:null)){e.next=12;break}return e.next=9,window.SEA.verify(n.props,a.pub);case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=null;case 13:if(c=e.t0,!a){e.next=20;break}return e.next=17,window.SEA.decrypt(c,a);case 17:e.t1=e.sent,e.next=21;break;case 20:e.t1=null;case 21:r=null!=(r=e.t1)?y(r):t,m.set(t,r);case 24:return e.abrupt("return",r);case 25:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),S=function(){var e=Object(d.a)(l.a.mark((function e(n,t,r){var a,c,o,i,s,d,f,p,b,h;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={name:"root",label:"root",color:"hsl(0, 70%, 50%)",loc:1},c=window.gun?window.gun.user().is:null,o=c?c.pub:"",(i=n.nodes.map((function(e){return Object.keys(e.props).map((function(n){return{id:"".concat(e.id.replace(o,""),"/").concat(n),props:e.props[n]}}))})).reduce((function(e,n){return[].concat(Object(u.a)(e),Object(u.a)(n))}))).sort((function(e,n){return e.id.localeCompare(n.id)})),s=0;case 6:if(!(s<i.length)){e.next=20;break}d=i[s],f=d.id.split("/"),p=a,b=l.a.mark((function e(n){var a,c,o,i,s,b;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=f[n],c=(p.children||[]).find((function(e){return e.label2===a})),f.length,c?p=c:(o={fullPath:d.id,name:a,label:a,label2:a,loc:15},p.children=[].concat(Object(u.a)(p.children||[]),[o]),p=o),i=3,s=.3,n!==f.length-1){e.next=18;break}return e.next=9,C(d);case 9:b=e.sent,p.name="random:".concat(Math.random(),"\r\n\r\n").concat(d.id,"\r\n").concat(b),p.fullPath=d.id,p.label2=a,p.label=t?"".concat(a," ").concat(b):"".concat(a).concat("/"+f[n-1]),p.label=""===r||p.name.indexOf(r)>=0?p.label:"",p.loc=Object.keys(d.props||{}).length>0?i:s,e.next=19;break;case 18:p.children||(p.children=[{fullPath:d.id,name:a,label:""===r||a.indexOf(r)>=0?a:"",loc:s}]);case 19:(p.children||[]).length>1&&p.children.find((function(e){return e.loc===i}))&&!p.children.find((function(e){return e.loc===s&&(e.children||[]).length>0}))&&(p.children=p.children.filter((function(e){return e.loc!==s})));case 20:case"end":return e.stop()}}),e)})),h=0;case 12:if(!(h<f.length)){e.next=17;break}return e.delegateYield(b(h),"t0",14);case 14:h++,e.next=12;break;case 17:s++,e.next=6;break;case 20:return e.abrupt("return",a);case 21:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}(),E=function(){var e=Object(r.useState)({nodes:O,links:k}),n=Object(f.a)(e,2),t=n[0],c=n[1],o=Object(r.useState)("http://localhost:8765/gun"),s=Object(f.a)(o,2),p=s[0],h=s[1],m=Object(r.useState)(""),y=Object(f.a)(m,2),C=y[0],S=y[1],E=Object(r.useState)(""),N=Object(f.a)(E,2),_=N[0],P=N[1],D=Object(r.useState)(""),I=Object(f.a)(D,2),R=I[0],A=I[1],L=Object(r.useState)(""),T=Object(f.a)(L,2),W=T[0],B=T[1],G=Object(r.useState)(new b.a),J=Object(f.a)(G,2),M=J[0],U=J[1];Object(r.useEffect)((function(){Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(R.length>0&&W.length>0)){e.next=5;break}return e.next=3,w(M.user(),R,W);case 3:v("ack",e.sent);case 5:case"end":return e.stop()}}),e)})))()}),[M,R,W]);var Y=a.a.useCallback((function(){var e=M;return R.length>0&&W.length>0&&(e=M.user()),e}),[M,R,W]);Object(r.useEffect)((function(){x.forEach((function(e){Y().get(e).off(),x.delete(e)}))}),[M,Y]);var F=Object(r.useState)(!0),V=Object(f.a)(F,2),$=V[0],q=V[1],z=a.a.useCallback((function(){q(!$)}),[q,$]),H=a.a.useCallback((function(){var e=new b.a(p);U(e),c((function(e){return{nodes:O,links:k}})),window.gun=e}),[U,c,p]);Object(r.useEffect)((function(){v("Peers set to: ".concat(Object.keys(M._.opt.peers).length>0?Object.keys(M._.opt.peers).reduce((function(e,n){return e+", "+n})):"No peers connected"))}),[M]);var K=a.a.useCallback((function(e){for(var n=Y(),t=0;t<e.length;t++)v("currentReference",e,n,"next:",e[t]),n=n.get(e[t]);return n}),[Y]),Q=a.a.useCallback((function(){c((function(){return{nodes:O,links:k}}))}),[c]),X=a.a.useCallback((function(e){Y().get(e).off(),c((function(n){var t=n.nodes;if(t.length<=1)return console.warn("Didn't delete node \"".concat(e,'", it is the last node')),n;v("Searching node with soul: ".concat(e));var r=t.findIndex((function(n){return n.id===e}));return-1===r?(console.error("No node found!"),n):(v("Removing node at index: ".concat(r)),t.splice(r,1),Object(i.a)(Object(i.a)({},n),{},{nodes:t}))}))}),[Y]),Z=a.a.useCallback((function(e){v("Removing unreferenced Nodes");var n=t.links.findIndex((function(n){return n.target===e}));v("Node still referenced?: ".concat(-1===n?"No":"Yes")),-1===n&&X(e)}),[t,X]),ee=a.a.useRef(null),ne=a.a.useCallback((function(e){c((function(n){var t=e._["#"];if(v('Setting data of node: "'.concat(t,'"')),!n)return n;var r=n.nodes,a=n.links,c=r.findIndex((function(e){return e.id===t}));if(-1===c)return console.error("id not found"),n;v('Found node with index: "'.concat(c,'"'));var o={},u=[],i=[],s=[],l=function(n){if("_"===n)return"continue";var l=a.findIndex((function(e){return e.label===n&&e.source===t}));-1!==l&&(Z(a[l].target),a.splice(l,1));var d=e[n];if(d&&void 0!==d["#"]){var f=d["#"];return u.push({id:f,props:{}}),i.push({source:t,target:f,label:n}),ee.current(f),void 0!==r[c].props[n]&&s.push(n),"continue"}o[n]=e[n]};for(var d in e)l(d);for(var f in v("Adding props"),v(o),r[c].props)s.includes(f)||void 0!==o[f]||(o[f]=r[c].props[f]);return r[c].props=o,r.push.apply(r,u),a.push.apply(a,i),v("New nodes"),v(r),{nodes:r,links:a}}))}),[ee,Z]),te=a.a.useCallback((function(e){x.has(e)||(console.log("Added listener to node: "+e),Y().get(e).on(ne,{change:!0}),x.add(e))}),[Y,ne]);a.a.useEffect((function(){ee.current=te}),[te]);var re=a.a.useCallback((function(e,n){return new Promise(function(){var t=Object(d.a)(l.a.mark((function t(r,a){var c,o,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c={vertices:[],edges:[]},t.next=3,K(e);case 3:if(v("node",o=t.sent),i=function(){var t=Object(d.a)(l.a.mark((function t(a){var o,i,s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=a._["#"],te(o),i={},t.t0=l.a.keys(a);case 4:if((t.t1=t.t0()).done){t.next=16;break}if("_"!==(s=t.t1.value)){t.next=8;break}return t.abrupt("continue",4);case 8:if(!a[s]||void 0===a[s]["#"]){t.next=13;break}return t.delegateYield(l.a.mark((function n(){var t,r;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=a[s]["#"],-1===c.vertices.findIndex((function(e){return e.id===t}))){n.next=4;break}return c.edges.push({source:o,target:t,label:s}),n.abrupt("return","continue");case 4:return n.next=6,re([].concat(Object(u.a)(e),[s]),o);case 6:return r=n.sent,c.vertices=[].concat(Object(u.a)(c.vertices),Object(u.a)(r.vertices)),c.edges=[].concat(Object(u.a)(c.edges),Object(u.a)(r.edges)),n.abrupt("return","continue");case 10:case"end":return n.stop()}}),n)}))(),"t2",10);case 10:if("continue"!==t.t2){t.next=13;break}return t.abrupt("continue",4);case 13:i[s]=a[s],t.next=4;break;case 16:c.vertices.push({id:o,props:i}),null!==n&&c.edges.push({source:n,target:o,label:e[e.length-1]}),v("Got Data from Graph:"),v(c),r(c);case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),!o._["#"]){t.next=11;break}return t.next=9,i(o);case 9:t.next=12;break;case 11:o.once(i);case 12:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}),[K,te]),ae=a.a.useCallback(function(){var e=Object(d.a)(l.a.mark((function e(n,t){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Q(),e.next=3,re(n,t);case 3:v((r=e.sent).vertices),v(r.edges),c((function(){return{nodes:r.vertices||O,links:r.edges||k}})),Z("gun");case 8:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),[c,Q,re,Z]);return v("graph:",t),window.graph=t,Object(g.jsxs)("div",{className:"App",style:{paddingTop:"600px"},children:[Object(g.jsx)("label",{children:"Endpoint "}),Object(g.jsx)("input",{value:p,onChange:function(e){h(e.target.value)},type:"text"}),Object(g.jsx)("label",{children:"Root "}),Object(g.jsx)("input",{value:C,onChange:function(e){S(e.target.value)},type:"text"}),Object(g.jsx)("label",{children:"Username "}),Object(g.jsx)("input",{value:R,onChange:function(e){A(e.target.value)},type:"text"}),Object(g.jsx)("label",{children:"Password "}),Object(g.jsx)("input",{value:W,onChange:function(e){B(e.target.value)},type:"password"}),Object(g.jsx)("label",{children:"Search "}),Object(g.jsx)("input",{value:_,onChange:function(e){P(e.target.value)},type:"text"}),Object(g.jsx)("br",{}),Object(g.jsx)("button",{onClick:function(){return ae([C],null)},children:"Load Data from Gun"}),Object(g.jsx)("button",{onClick:function(){return H()},children:"Load Endpoint"}),Object(g.jsx)("button",{onClick:function(){return z()},children:"Toggle Values"}),Object(g.jsx)("div",{style:{height:"1100px",color:"black"},children:Object(g.jsx)(j,{graph:t,valuesEnabled:$,search:_})})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(g.jsx)(E,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[353,1,2]]]);
//# sourceMappingURL=main.12924f14.chunk.js.map