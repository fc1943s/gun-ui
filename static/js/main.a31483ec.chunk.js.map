{"version":3,"sources":["../node_modules/gun sync","App.js","serviceWorker.js","index.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","log","window","console","MyResponsiveBubble","root","useState","margin","top","right","bottom","left","identity","colorBy","label","x","data","enableLabels","value","colors","scheme","padding","labelSkipRadius","labelTextColor","borderWidth","borderColor","from","defs","type","background","color","rotation","lineWidth","spacing","fill","match","depth","animate","motionStiffness","motionDamping","require","gunListeners","Set","vertices","props","edges","authUser","user","username","password","Promise","reject","auth","getRootData","graph","valuesEnabled","search","newGraph","loc","gun","is","pub","nodes","map","node","Object","prop","replace","reduce","a","b","sort","localeCompare","i","length","innerNodes","split","currObj","j","innerNode","currCurrObj","children","find","label2","fullPath","name","valueOff","propsText","JSON","stringify","indexOf","filter","App","links","setGraph","endpoint","setEndpoint","setRoot","setSearch","setUsername","setPassword","Gun","setGun","useEffect","getGunRoot","React","useCallback","currentReference","forEach","soul","get","off","delete","setValuesEnabled","toggleValues","loadEndpoint","newGun","_graph","_","opt","peers","getPath","path","resetGraph","removeNode","warn","nodeId","findIndex","error","splice","removeUnreferencedNode","index","edge","target","addGunListenerRef","useRef","handleNodeChange","change","oldNodes","oldLinks","idx","newProps","newVertices","newEdges","propsToRemove","childEdgeIndex","source","propVal","undefined","newNodeSoul","push","current","p","includes","addGunListener","has","on","add","getDataFromGun","parentId","_reject","process","nodeProperties","childSoul","vertex","childGraph","once","insertDataFromGun","className","style","onChange","ev","onClick","height","Boolean","location","hostname","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.a31483ec.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 161;","import './App.css';\n\nimport Gun from 'gun';\nimport 'gun/sea';\nimport React, { useEffect, useState } from 'react';\n\n// import { ResponsiveCirclePacking } from '@nivo/circle-packing'\nimport { ResponsiveBubble } from '@nivo/circle-packing'\n\n\nfunction log (...p) {\n  if(window.log) {\n    console.log(...p);\n  }\n}\n// make sure parent container have a defined height when using\n// responsive component, otherwise height will be 0 and\n// no chart will be rendered.\n// website examples showcase many properties,\n// you'll often use just a few of them.\nconst MyResponsiveBubble = ({ root /* see root tab */ }) => {\n  const [zoomedId, setZoomedId] = useState(null);\n  return (\n  // <ResponsiveCirclePacking\n  <ResponsiveBubble\n    // data={root}\n    root={root}\n    margin={{ top: 20, right: 20, bottom: 20, left: 20 }}\n    // id=\"fullPath\"\n    identity=\"name\"\n    colorBy=\"depth\"\n    label={x => x.data.label}\n    enableLabels={true}\n    value=\"loc\"\n    // zoomedId={zoomedId}\n    // onClick={node => {\n    //   setZoomedId(zoomedId === node.id ? null : node.id)\n    // }}\n    colors={{ scheme: 'spectral' }}\n    padding={0}\n    labelSkipRadius={0}\n    labelTextColor=\"black\"\n    borderWidth={2}\n    borderColor={{ from: 'color' }}\n    defs={[\n      {\n        id: 'lines',\n        type: 'patternLines',\n        background: 'none',\n        color: 'inherit',\n        rotation: -75,\n        lineWidth: 5,\n        spacing: 8\n      }\n    ]}\n    fill={[{ match: { depth: 1 }, id: 'lines' }]}\n    animate={true}\n    motionStiffness={90}\n    motionDamping={12}\n  />\n)}\n\n\n// const gun = new Gun('http://192.168.178.64:8765/gun');\nrequire('gun/lib/open.js');\n\nlet gunListeners = new Set();\n\nconst vertices = [{ id: 'gun', props: { root: '' } }];\nconst edges = [];\n\n// const sleep = async (ms) => {\n//   return new Promise((resolve, _reject) => {\n//     setTimeout(() => {\n//       resolve();\n//     }, ms);\n//   });\n// };\n\nconst authUser = (user, username, password) => {\n  return new Promise((resolve, reject) => {\n    try {\n      user.auth(username, password, resolve)\n    } catch (e) {\n      reject(e)\n    }\n  });\n};\n\nfunction App() {\n  const [graph, setGraph] = useState({\n    nodes: vertices,\n    links: edges,\n  });\n\n  const [endpoint, setEndpoint] = useState('http://localhost:8765/gun');\n\n  const [root, setRoot] = useState('GunRecoil');\n  const [search, setSearch] = useState('');\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n\n  const [gun, setGun] = useState(new Gun());\n\n  useEffect(() => {\n    (async () => {\n      if (username.length > 0 && password.length > 0) {\n        const ack = await authUser(gun.user(), username, password);\n        log('ack', ack);\n      }\n    })()\n  }, [gun, username, password]);\n\n  const getGunRoot = React.useCallback(() => {\n    let currentReference = gun;\n    if (username.length > 0 && password.length > 0) {\n      currentReference = gun.user();\n    }\n    return currentReference;\n  }, [gun, username, password]);\n\n\n  useEffect(() => {\n    gunListeners.forEach((soul) => {\n      const gunRoot = getGunRoot();\n      gunRoot.get(soul).off();\n      gunListeners.delete(soul);\n    });\n  }, [gun, getGunRoot]);\n\n  const [valuesEnabled, setValuesEnabled] = useState(true);\n\n  const toggleValues = React.useCallback(() => {\n    setValuesEnabled(!valuesEnabled);\n  }, [setValuesEnabled, valuesEnabled]);\n\n  const loadEndpoint = React.useCallback(() => {\n    const newGun = new Gun(endpoint);\n    setGun(newGun);\n    setGraph((_graph) => {\n      return {\n        nodes: vertices,\n        links: edges,\n      };\n    });\n    window.gun = newGun;\n  }, [setGun, setGraph, endpoint]);\n\n  useEffect(() => {\n    log(\n      `Peers set to: ${\n        Object.keys(gun._.opt.peers).length > 0\n          ? Object.keys(gun._.opt.peers).reduce(\n          (a, b) => a + ', ' + b\n          )\n          : 'No peers connected'\n      }`\n    );\n  }, [gun]);\n\n  const getPath = React.useCallback((path) => {\n    let currentReference = getGunRoot();\n\n    for (let i = 0; i < path.length; i++) {\n      log('currentReference', path, currentReference, 'next:', path[i]);\n      currentReference = currentReference.get(path[i]);\n    }\n    return currentReference;\n  }, [getGunRoot]);\n\n  const resetGraph = React.useCallback(() => {\n    setGraph(() => {\n      return {\n        nodes: vertices,\n        links: edges,\n      };\n    });\n  }, [setGraph]);\n\n  const removeNode = React.useCallback((soul) => {\n    let gun = getGunRoot();\n    gun.get(soul).off();\n    setGraph((data) => {\n      let nodes = data.nodes;\n      if (nodes.length <= 1) {\n        console.warn(\n          `Didn't delete node \"${soul}\", it is the last node`\n        );\n        return data;\n      }\n      log(`Searching node with soul: ${soul}`);\n      const nodeId = nodes.findIndex((node) => node.id === soul);\n      if (nodeId === -1) {\n        console.error(`No node found!`);\n        return data;\n      }\n      log(`Removing node at index: ${nodeId}`);\n      nodes.splice(nodeId, 1);\n      return { ...data, nodes: nodes };\n    });\n  }, [getGunRoot]);\n\n  const removeUnreferencedNode = React.useCallback((soul) => {\n    log(`Removing unreferenced Nodes`);\n    const index = graph.links.findIndex((edge) => edge.target === soul);\n    log(`Node still referenced?: ${index === -1 ? 'No' : 'Yes'}`);\n    if (index === -1) {\n      removeNode(soul);\n    }\n  }, [graph, removeNode]);\n\n  const addGunListenerRef = React.useRef(null);\n\n  const handleNodeChange = React.useCallback((change) => {\n    setGraph((data) => {\n      const id = change['_']['#'];\n\n      log(`Setting data of node: \"${id}\"`);\n\n      if (!data) return data;\n\n      let oldNodes = data.nodes;\n      let oldLinks = data.links;\n\n      const idx = oldNodes.findIndex((node) => node.id === id);\n\n      if (idx === -1) {\n        console.error('id not found');\n        return data;\n      }\n      log(`Found node with index: \"${idx}\"`);\n\n      let newProps = {};\n      let newVertices = [];\n      let newEdges = [];\n      let propsToRemove = [];\n\n      for (const prop in change) {\n        // Ignore the soul\n        if (prop === '_') continue;\n        // Is this property currently given to a child node?\n        const childEdgeIndex = oldLinks.findIndex((edge) => {\n          return edge.label === prop && edge.source === id;\n        });\n        // If so, remove the edge\n        if (childEdgeIndex !== -1) {\n          removeUnreferencedNode(oldLinks[childEdgeIndex].target);\n          oldLinks.splice(childEdgeIndex, 1);\n        }\n        // Property is new child Node\n        const propVal = change[prop];\n        if (propVal && propVal['#'] !== undefined) {\n          // Add new node\n          const newNodeSoul = propVal['#'];\n          newVertices.push({\n            id: newNodeSoul,\n            props: {},\n          });\n          newEdges.push({\n            source: id,\n            target: newNodeSoul,\n            label: prop,\n          });\n          addGunListenerRef.current(newNodeSoul);\n          // Remove old property from parent if it exists\n          if (oldNodes[idx].props[prop] !== undefined) {\n            propsToRemove.push(prop);\n          }\n          continue;\n        }\n        // Add property to node props\n        newProps[prop] = change[prop];\n      }\n\n      log('Adding props');\n      log(newProps);\n\n      for (const p in oldNodes[idx]['props']) {\n        if (!propsToRemove.includes(p) && newProps[p] === undefined) {\n          newProps[p] = oldNodes[idx]['props'][p];\n        }\n      }\n\n      oldNodes[idx]['props'] = newProps;\n\n      oldNodes.push(...newVertices);\n      oldLinks.push(...newEdges);\n\n      log('New nodes');\n      log(oldNodes);\n\n      return {\n        nodes: oldNodes,\n        links: oldLinks,\n      };\n    });\n  }, [addGunListenerRef, removeUnreferencedNode]);\n\n  const addGunListener = React.useCallback((soul) => {\n    if (!gunListeners.has(soul)) {\n      console.log('Added listener to node: ' + soul);\n\n      let gun = getGunRoot();\n      gun.get(soul).on(handleNodeChange, { change: true });\n      gunListeners.add(soul);\n    }\n  }, [getGunRoot, handleNodeChange]);\n\n  React.useEffect(() => {\n    addGunListenerRef.current = addGunListener;\n  }, [addGunListener]);\n\n\n  const getDataFromGun = React.useCallback((path, parentId) => {\n    return new Promise(async (resolve, _reject) => {\n      let graph = { vertices: [], edges: [] };\n      const gun = getGunRoot();\n      const node = await getPath(path);\n      log(\"node\", node);\n\n      const process = async (nodeProperties) => {\n        const soul = nodeProperties['_']['#'];\n\n        addGunListener(soul);\n\n        let props = {};\n        for (let prop in nodeProperties) {\n          if (prop === '_') continue;\n          if (\n            nodeProperties[prop] &&\n            nodeProperties[prop]['#'] !== undefined\n          ) {\n            const childSoul = nodeProperties[prop]['#'];\n            // If the vertex is already listed (referenceed multiple times)\n            if (\n              graph.vertices.findIndex(\n                (vertex) => vertex.id === childSoul\n              ) !== -1\n            ) {\n              graph.edges.push({\n                source: soul,\n                target: childSoul,\n                label: prop,\n              });\n              continue;\n            }\n            let childGraph = await getDataFromGun(\n              [...path, prop],\n              soul\n            );\n            graph.vertices = [\n              ...graph.vertices,\n              ...childGraph.vertices,\n            ];\n            graph.edges = [...graph.edges, ...childGraph.edges];\n            continue;\n          }\n          props[prop] = nodeProperties[prop];\n        }\n        graph.vertices.push({\n          id: soul,\n          props,\n        });\n        if (parentId !== null) {\n          graph.edges.push({\n            source: parentId,\n            target: soul,\n            label: path[path.length - 1],\n          });\n        }\n        log('Got Data from Graph:');\n        log(graph);\n\n        resolve(graph);\n      }\n      if (node['_']['#']) {\n        await process(node);\n      } else {\n        node.once(process);\n      }\n    });\n  }, [getPath, addGunListener, getGunRoot]);\n\n  const insertDataFromGun = React.useCallback(async (path, parentId) => {\n    resetGraph();\n    const graph = await getDataFromGun(path, parentId);\n\n    log(graph.vertices);\n    log(graph.edges);\n\n    setGraph(() => {\n      return {\n        nodes: graph.vertices || vertices,\n        links: graph.edges || edges,\n      };\n    });\n    removeUnreferencedNode('gun');\n  }, [setGraph, resetGraph, getDataFromGun, removeUnreferencedNode]);\n\n\n  // const _graphConfig = {\n  //   width: 800,\n  //   height: 800,\n  //   directed: true,\n  //   nodeHighlightBehavior: true,\n  //   staticGraphWithDragAndDrop: false, // If false, can be removed\n  //   automaticRearrangeAfterDropNode: false, // If false, can be removed\n  //   node: {\n  //     renderLabel: false,\n  //     size: 1000,\n  //     viewGenerator: (node) => <Vertex node={node} />,\n  //   },\n  //   link: {\n  //     highlightColor: 'blue',\n  //     renderLabel: true,\n  //     highlightFontWeight: 'bold',\n  //     semanticStrokeWidth: true,\n  //     fontSize: 12,\n  //   },\n  //   d3: {\n  //     gravity: -1000,\n  //     linkLength: 50,\n  //   },\n  // };\n\n  // const _windowStyle = {\n  //   backgroundColor: '#282828',\n  //   padding: '2px',\n  // };\n  //\n  // const _graphStyle = {\n  //   backgroundColor: '#FFF',\n  // };\n\n  log('graph:', graph);\n  window.graph = graph;\n\n  return (\n    <div className=\"App\" style={{ 'padding-top': '600px' }}>\n      <label>Endpoint </label>\n      <input\n        value={endpoint}\n        onChange={(ev) => {\n          setEndpoint(ev.target.value);\n        }}\n        type=\"text\"\n      />\n      <label>Root </label>\n      <input\n        value={root}\n        onChange={(ev) => {\n          setRoot(ev.target.value);\n        }}\n        type=\"text\"\n      />\n      <label>Search </label>\n      <input\n        value={search}\n        onChange={(ev) => {\n          setSearch(ev.target.value);\n        }}\n        type=\"text\"\n      />\n      <label>Username </label>\n      <input\n        value={username}\n        onChange={(ev) => {\n          setUsername(ev.target.value);\n        }}\n        type=\"text\"\n      />\n      <label>Password </label>\n      <input\n        value={password}\n        onChange={(ev) => {\n          setPassword(ev.target.value);\n        }}\n        type=\"password\"\n      />\n      <br />\n      <button onClick={() => insertDataFromGun([root], null)}>\n        Load Data from Gun\n      </button>\n      <button onClick={() => loadEndpoint()}>Load Endpoint</button>\n\n      <button onClick={() => toggleValues()}>Toggle Values</button>\n\n      <div style={{ height: \"1100px\", color: \"black\" }}>\n        <MyResponsiveBubble root={getRootData(graph, valuesEnabled, search)} />\n      </div>\n\n      {/*<div style={windowStyle}>*/}\n      {/*  <div style={graphStyle}>*/}\n      {/*    <Graph id=\"graph-id\" data={graph} config={graphConfig} />*/}\n      {/*  </div>*/}\n      {/*</div>*/}\n\n    </div>\n  );\n}\n\nconst getRootData = (graph, valuesEnabled, search) => {\n  const newGraph = {\n    \"name\": \"root\",\n    label: 'root',\n    color: `hsl(0, 70%, 50%)`,\n    loc: 1\n  };\n\n  const user = window.gun ? window.gun.user().is : null;\n  let pub = user ? user.pub : '';\n\n  const nodes = graph.nodes.map((node) => {\n      return Object.keys(node.props).map((prop) => ({\n        id: `${node.id.replace(pub, '')}/${prop}`,\n        props: node.props[prop]\n      }))\n    }).reduce((a, b) => [...a, ...b])\n  ;\n  // log('nodes', nodes);\n\n  nodes.sort((a, b) => a.id.localeCompare(b.id));\n\n  for (let i = 0; i < nodes.length; i++) {\n    const node = nodes[i];\n    const innerNodes = node.id.split(\"/\");\n\n    let currObj = newGraph;\n    for (let j = 0; j < innerNodes.length; j++) {\n      const innerNode = innerNodes[j];\n\n      let currCurrObj = (currObj.children || []).find((x) => x.label2 === innerNode)\n\n      if (j === innerNodes.length - 1) {\n      }\n\n      if (!currCurrObj) {\n        let x = {\n          fullPath: node.id,\n          name: innerNode,\n          label: innerNode,\n          label2: innerNode,\n          loc: 15\n        }\n        currObj.children = [...currObj.children || [], x];\n        currObj = x;\n      } else {\n        currObj = currCurrObj;\n      }\n\n      const valueOn = 3;\n      const valueOff = 0.3;\n\n      if (j === innerNodes.length - 1) {\n        const propsText = JSON\n          .stringify(node.props, null, 4)\n          .replace(/\\\\/g, \"\")\n          .replace(/,/g, \",\\r\\n\");\n\n        currObj.fullPath = node.id;\n        currObj.label2 = innerNode;\n        currObj.name = `${node.id}\\r\\n\\r\\n${propsText}`;\n        // currObj.name = {a:1,b:2};\n        currObj.label = !valuesEnabled ? `${innerNode}${(\"/\" + innerNodes[j - 1])}` : currObj.name;\n        currObj.label = search === '' ? currObj.label : (currObj.name.indexOf(search) >= 0 ? currObj.label : '');\n        // currObj.color = `hsl(${Math.round(255 * Math.random())}, 70%, 50%)`;\n        currObj.loc = Object.keys(node.props || {}).length > 0 ? valueOn : valueOff;\n        // currObj.children = currObj.loc === valueOff ? [] : Object.keys(node.props).map((key) => ({\n        //     fullPath: node.id + \"key\",\n        //     name: key,\n        //     label: node.props[key],\n        //     loc: valueOn\n        //   }))\n      } else {\n        if (!currObj.children) {\n          currObj.children = [\n            {\n              fullPath: node.id,\n              name: innerNode,\n              label: innerNode,\n              loc: valueOff\n            }\n          ]\n        }\n      }\n\n      if ((currObj.children || []).length > 1\n        && currObj.children.find((x) => x.loc === valueOn)\n        && !currObj.children.find((x) => x.loc === valueOff && (x.children || []).length > 0)) {\n        currObj.children = currObj.children.filter((x) => x.loc !== valueOff)\n      }\n    }\n  }\n\n  return newGraph;\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}